
# ✅ 修复后测试验证清单

## Phase 1: 基础功能稳定性测试

| 测试ID | 场景 | 操作步骤 | 预期结果 | 验证方式 |
|--------|------|----------|----------|----------|
| T-001 | 经典共振按钮（无筛选） | 1. 进入页面<br>2. 确保无分类筛选<br>3. 点击"🟢 经典共振搭配" | 页面刷新后显示2种食材及分析结果 | 观察页面是否正常加载 |
| T-002 | 经典对比按钮（Vegan模式） | 1. 开启"仅植物基Vegan"<br>2. 点击"🔴 经典对比碰撞" | 如果无Vegan对比组，显示提示；不卡死 | 检查是否有toast提示 |
| T-003 | 示例卡片点击 | 点击三个示例卡片（共振/平衡/对比） | 正确跳转实验台并加载对应食材 | 验证食材是否正确选中 |
| T-004 | 加入实验按钮 | 点击"➕ 加入实验"（测试第3、第4种食材） | 成功添加，添加第5种时提示限制 | 检查雷达图是否更新 |
| T-005 | 配方台比例调整 | 选择3种食材后切换到"配方台"，调整滑块 | 雷达图面积实时变化 | 观察雷达图变化 |

## Phase 2: AI对话系统压力测试

| 测试ID | 场景 | 操作步骤 | 预期结果 | 验证方式 |
|--------|------|----------|----------|----------|
| T-101 | 正常单轮对话 | 输入"为什么这两个食材搭配？"发送 | AI回复一条，无重复 | 检查聊天记录数量 |
| T-102 | 快速双击发送 | 快速连续点击发送按钮2次 | 仅发送一次，第二次被忽略 | 观察是否只有一条消息 |
| T-103 | 切换食材后对话 | 进行对话后，回实验台更换食材 | 对话历史清空，出现新上下文提示 | 验证历史是否清空 |
| T-104 | API超时处理 | 模拟网络延迟或错误API Key | 显示错误信息，"重试"按钮可用 | 检查错误提示和重试功能 |
| T-105 | 快捷问题按钮 | 点击三个快捷问题按钮 | 每个问题只发送一次 | 验证消息不重复 |
| T-106 | 重试功能 | 制造错误后点击"🔄 重试" | 移除错误消息，重新发送原问题 | 检查消息是否正确删除 |

## Phase 3: 边界与异常测试

| 测试ID | 场景 | 操作步骤 | 预期结果 |
|--------|------|----------|----------|
| T-201 | 单食材选择 | 只选1种食材 | 显示提示"请再选择1种食材"，不报错 |
| T-202 | 空搜索 | 在搜索框输入不存在的内容 | 显示"0种食材可选"，界面不崩 |
| T-203 | 极速切换标签 | 快速点击实验台/配方台/设置 | 状态不混乱，食材选择保持 |
| T-204 | 深夜长时运行 | 页面静置30分钟后发送消息 | 自动重置思考锁，可正常对话 |

## Phase 4: 教育体验测试

| 测试ID | 场景 | 操作步骤 | 预期结果 |
|--------|------|----------|----------|
| T-301 | 术语解释 | 查看分析结果中的"Jaccard"等术语 | 有tooltip或展开解释 |
| T-302 | "为什么"展开 | 点击"为什么它们产生共振？"展开项 | 显示分子层面解释 |
| T-303 | 发现日志 | 点击"💾 保存到日志"按钮 | 显示保存成功toast，日志有记录 |
| T-304 | 日志查看 | 查看发现日志展开项 | 显示最近10条实验记录 |

---

## 🔍 快速验证命令

```bash
# 1. 语法检查
python -m py_compile app_fixed.py

# 2. 运行应用
streamlit run app_fixed.py

# 3. 检查关键状态变量（在浏览器控制台执行）
# 查看session state
```

---

## 🎯 关键验证点

### 1. 经典按钮修复验证
- [ ] 连续点击"经典共振"10次，无一次卡死
- [ ] Vegan模式下点击按钮，有友好提示
- [ ] 示例卡片点击后正确加载食材

### 2. AI对话修复验证
- [ ] 发送消息后，is_ai_thinking正确设置为True
- [ ] 收到回复后，is_ai_thinking正确设置为False
- [ ] 快速双击只发送一条消息
- [ ] 重试按钮正确删除错误消息

### 3. 教育体验验证
- [ ] 分析结果中有"为什么"展开项
- [ ] 发现日志功能正常工作
- [ ] 术语有tooltip解释（可添加更多）

---

*测试清单版本: V2.2-FIXED*
